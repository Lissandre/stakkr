sudo: required
dist: trusty

language: python
python:
    - "3.4"
    - "3.5"
    - "3.6"

install:
    - pip install .
    - stakkr-init
    - pip install -r requirements-dev.txt

env:
    global:
        secure: ZcG2MFV/FnCrPJaiyKKt1Rqd7W0NnEOIpn0r+OS4u4N2MKsCjeCzoZHGovXb7Av9AHokLvz0FWwD6Gd+WRoj66zdIPrDflAuWs9VEMCbhotLYb0NenU8AJBjO5V61BgdBmaCN33ZfQzMBE8z3B2RWRqk01KHDXEOdBASob4yKRetwq1PEkHMeJUtOEzVtYPu+SkBVR4xg4yW07zEtCxpZBg5I/qpunym+F7Jb/rzXwNA2csYy0NZaBGw9SzHoQZwF4c7/oUERWq7A+MzdH3zwarDBwTjb9VagIzt0jBeWd41sIqgjqRLj/qDpn5Ah1ukuSkPPVcrLLiCoXi0zudWFE68SE+Wch3iabUdQnsUc7PAg5GqHmKKge83x3KBDo9Y4PakHbFgH4Pt48GNCeY+ZVe6xNLs7PrVox5I5ZE8KScpLqYnBN0n+KS9K5pBP+cslHHb1YttJc7tiaFJhlgByEtIoUv0PMkQBiyaj6i4q3JU7l95pzrY5PIs/NBdxssF/G+QG/O4Xtod2/+xARhnQlrTbWA0eFtbzR/phcrd6iE+/3EQqxsDWJKXqMXAbTjmkADyAWj2t+4344EQyUak6+cXcSX40eGmCX+RkQexaGZGCe9WaBYUyhGrg8F96XyLS5P4mFtYU78vNFByzRv+jEIh/VKervA7y0/pwNe1+xo=

notifications:
    slack:
        secure: "VQfnV2SKRv9PFK3GPPhTZZq+etFS0mGTtbBWILoK3r35W0HLFiEAl54zZkZkojOZgaFad97y8mXrIMxl3X37EHxbA/yYaAkApXfRU6DPaOj+VNJP5IOpU8SVJxzNTvTQ2ORzYUNwXxoxuywOVwKpJP1v/HrFStvEvotAPhnA0oM+qCkqB7NRlpZBbWnpDdGqPnG1p6AHjfNjXjyHfAGHE069k4XWCRNxXPKaosJluE1ExIioIbUd+q9ZujUzCRUEJbsKmchVJMWfqHnoKKKxIr0vkL1kWGT+4L5o0YHaJRM1Ei9Bu1FKtVKK+389hWGh+ONOjlHj/U1CzKlKI49Exin2JybioauWgwodn6OO4kYjm1A0obiYGyyQceleCXpSNmq6xLPDP1d3edMki4VKWMEnYYWoFW3gyEbuf8+yf1CHMxx1YzGdhy6pCEJmzzRjWYBLEF0Tg9LfJWbCh8giQPjvnFSwCzM+Gxi1XHk1NNEO0l1yTC/LNL8uZfBG9dmFCd4JvDXGxr2RHfxjP62DKERsBP5iviV8fOQvd7krprVGNKv8SDi0UxIAtZxyrJ2yvpVkrFsWs0EB3waW0dvGWkzP70J8iGOtUEHex/HhAq0x7Xu35StGnY3RO7hLXQaG6f2xXakgYpdet6wN0vvUpEEaE6IrSPUWyjf5oK49Zp4="

before_script:
    - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
    - chmod +x ./cc-test-reporter
    - ./cc-test-reporter before-build

# command to run tests
script: py.test --cov=stakkr tests/

after_script:
    - coverage xml
    - if [[ "$TRAVIS_PYTHON_VERSION" == "3.6" ]]; then ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT; fi
